---
layout: article
title:  "MySQL 소스코드 분석"
date:   2018-03-01 10:00:00 Z
author: Rocky Lim
categories: research
excerpt: "디렉토리 구조"
image:
comments: true
locale: "vn"
share: true
ads: true
---


{% include toc.html %}

# 7가지 Major Directories

1. BUILD
2. client
3. Docs
4. myisam
5. mysys - toolbox directory. e.g. sort, changing charactoer set... 
6. sql - parser, handler, statement... functions.
7. vio - virtual I/O, vio routines are wrappers for the various network I/O calls that happen with different protocols. 

# Path

* /sql/mysqld.cc

~~~C
int main(int argc, char **argv)
  {
    _cust_check_startup();
    (void) thr_setconcurrency(concurrency);
    init_ssl();
    server_init();                             // 'bind' + 'listen'
    init_server_components();
    start_signal_handler();
    acl_init((THD *)0, opt_noacl);
    init_slave();
    create_shutdown_thread();
    create_maintenance_thread();
    handle_connections_sockets(0);             // next path
    DBUG_PRINT("quit",("Exiting main thread"));
    exit(0);
  }
~~~

main 함수 부분. mysql 시작

~~~C
	handle_connections_sockets (arg __attribute__((unused))
  {
     if (ip_sock != INVALID_SOCKET)
     {
       FD_SET(ip_sock,&clientFDs);
       DBUG_PRINT("general",("Waiting for connections."));
       while (!abort_loop)
       {
         new_sock = accept(sock, my_reinterpret_cast(struct sockaddr*)
           (&cAddr),             &length);
         thd= new THD;
         if (sock == unix_sock)
         thd->host=(char*) localhost;
         create_new_thread(thd);            // !
         }

~~~

main thread가 새로 들어오는 클라이언트의 리퀘스트를 항상 듣고있다.








